---
title: "Untitled"
output: html_document
---
```{r}
predprey<-read.csv('predprey.csv')
library(tidyverse)
install.packages("plotly")
library(plotly)
```

#Looking at latitude effect on prey and pred with colour longitude
```{r}
ggplot(data=predprey, aes(x=Latitude, y=Prey_mass, colour=Longitude))+
  geom_point()+
  geom_smooth(method='lm')
ggplot(data=predprey, aes(x=Latitude, y=Predator_mass, colour=Longitude))+
  geom_point()+
  geom_smooth(method='lm')
```
Check to see if linear model for pred mass is significant
```{r}
predlong<- lm(predprey$Predator_mass~predprey$Longitude) #significant and negative 
summary(predlong)

predlat<-lm(predprey$Predator_mass~predprey$Latitude) #significant and positive
summary(predlat)

```
```{r}
preylat<-lm(predprey$Prey_mass~predprey$Latitude) #significant and positive
summary(preylat)

preylong<-lm(predprey$Prey_mass~predprey$Longitude) #not significant
summary(preylong)
```


#Looking at how data is distributed between longitude~latitude
```{r}
longlat<- lm(predprey$Latitude~predprey$Longitude)
plot(longlat)

```
Very not regular, log transform?

#TRYING TO SEE TAXONOMIC DIV AT DIF LATITUDES
    
```{r}
ggplot(data = predprey, aes(x = Predator_common_name)) +
  geom_bar()
ggplot(data = predprey, aes(x = Prey_common_name)) +
  geom_bar()
```


```{r}
a<- predprey %>%
 group_by(Latitude) %>% 
 mutate(length(unique(Predator_common_name)))
 
lma<-glm(length(unique(Predator_common_name))~Latitude, data=predprey)
summary(lma)
 
b<- predprey %>%
 group_by(Latitude) %>% 
 mutate(length(unique(Prey_common_name)))
```



#PCA
```{r}
library(car)
library(psych)
library(multcomp)


cutpredprey<-predprey %>% 
  dplyr::select(Predator, Predator_common_name, Predator_total_length, Predator_mass, Prey_common_name, Prey_taxon, Prey_length, Prey_mass, Geographic_location, Latitude, Longitude, Depth, Mean_annual_temp, Specific_habitat)

str(cutpredprey)
cutpredprey$Predator<- as.numeric(cutpredprey$Predator)
cutpredprey$Predator_common_name<- as.numeric(cutpredprey$Predator_common_name)
cutpredprey$Prey_common_name<- as.numeric(cutpredprey$Prey_common_name)
cutpredprey$Prey_taxon<- as.numeric(cutpredprey$Prey_taxon)
cutpredprey$Geographic_location<- as.numeric(cutpredprey$Geographic_location)
cutpredprey$Depth<- as.numeric(cutpredprey$Depth)
cutpredprey$Specific_habitat<- as.numeric(cutpredprey$Specific_habitat)

cutpredprey<- cutpredprey[complete.cases(cutpredprey),]
predprey_cor <- cor(cutpredprey)
det(predprey_cor) #we want to see that our determinant is greater than the necessary value of 0.00001, and it is
```
```{r}
pc1 <- principal(predprey_cor, nfactors =14, rotate = "none")
pc1
#There are six SS loadings with a value over 1
```
```{r}
plot(pc1$values, type = "b") #6 components here is also reasonable imo
```
```{r}
pc2 <- principal(predprey_cor, nfactors = 6, rotate = "none")
pc2
```
```{r}
pc3 <- principal(predprey_cor, nfactors = 6, rotate = "varimax")
pc3
```
```{r}
print.psych(pc3, cut = 0.3, sort = TRUE)
```
Our data has structure and certain variables clump together. Will interpret these results as a group.










